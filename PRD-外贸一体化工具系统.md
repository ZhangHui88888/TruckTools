# 产品需求文档 (PRD)
## 卡车外贸综合工具平台 - MVP版本（展会客户管理与邮件营销模块）

**版本**: v1.1  
**创建日期**: 2025年12月2日  
**产品负责人**: [待定]  
**最后更新**: 2025年12月3日

---

## 1. 引言

### 1.1 背景

#### 1.1.1 行业背景

在卡车外贸行业中，从业者需要处理大量复杂的工作流程，包括客户开发与管理、报价与订单处理、物流跟踪、供应链协同、文档管理等。目前市场上的工具分散，没有针对卡车外贸行业的一体化解决方案，导致：

- **工具分散**: 使用多个独立软件，数据无法互通
- **学习成本高**: 需要熟悉多个系统的操作逻辑
- **效率低下**: 在不同工具间切换，重复录入数据
- **数据孤岛**: 客户信息、订单信息、物流信息分散在不同系统

#### 1.1.2 MVP模块背景

参加国际展销会是获取潜在客户的重要渠道。销售人员在展会期间会收集大量客户名片，但后续的信息整理、客户跟进和邮件营销往往效率低下，存在以下痛点：

- **信息录入繁琐**: 手动录入名片信息耗时费力，容易出错
- **客户优先级管理混乱**: 无法有效标记和排序重点客户
- **邮件跟进效率低**: 逐个发送邮件，无法批量个性化营销
- **跟进记录不完整**: 缺乏系统化的发送记录和结果追踪

#### 1.1.3 产品定位

本产品定位为**卡车外贸行业的一体化工具平台**，采用模块化设计，未来将整合客户管理、订单管理、物流跟踪、文档管理、数据分析等多个功能模块，打造外贸从业者的"数字化工作台"。

**本期（MVP）范围**：优先实现展会客户管理与邮件营销模块，验证产品核心价值，为后续模块扩展奠定基础。

### 1.2 目标用户

**主要用户角色**:
- **外贸销售人员**: 直接参加展会，负责收集名片和客户跟进
- **销售经理**: 管理客户信息，制定邮件营销策略
- **市场营销人员**: 设计邮件模板，执行批量营销活动

**用户画像**:
- 年龄: 25-45岁
- 行业: 卡车制造、汽车配件、物流设备等外贸行业
- 痛点: 展会后客户信息管理混乱，邮件跟进效率低
- 需求: 快速整理名片信息，批量发送个性化邮件

### 1.3 产品愿景

#### 1.3.1 长期愿景

打造卡车外贸行业的**一站式数字化工作平台**，通过集成化的工具模块，覆盖外贸业务全流程：

- **客户管理**: 从名片识别到客户关系维护
- **销售管理**: 报价、合同、订单全流程管理
- **供应链协同**: 采购、库存、物流一体化
- **数据智能**: 基于AI的商机预测、风险预警
- **文档管理**: 合同、发票、证书等文档的智能归档
- **团队协作**: 多人协同、权限管理、工作流审批

成为外贸从业者的"数字化工作台"，提升整体业务效率30%以上。

#### 1.3.2 本期愿景（MVP）

完成**展会客户管理与邮件营销模块**，验证核心价值假设：

1. ✅ 通过AI技术简化客户信息采集流程
2. ✅ 通过自动化营销工具提升客户转化效率
3. ✅ 建立可扩展的平台架构，为后续模块奠定基础
4. ✅ 在前端预留其他功能模块入口，展示产品规划蓝图

---

## 2. 用户故事与场景描述

### 2.1 用户故事

**Story 1: 展会名片快速录入**
> 作为一名外贸销售人员，我希望能够通过拍照的方式快速录入名片信息，并标记客户优先级，这样我就可以在展会结束后快速整理出重点客户清单，而不需要手动逐个录入。

**验收标准**:
- 支持批量上传名片图片
- 可在上传时为每张名片设置优先级（如：高/中/低或1-5星）
- 系统自动识别名片信息并生成结构化数据
- 识别字段包括：姓名、公司、职位、电话、邮箱、地址、网站等
- 支持识别微信和WhatsApp二维码
- 自动记录上传时间作为会面时间

---

**Story 2: 客户信息表格管理**
> 作为一名销售经理，我希望能够在一个结构化的表格中查看所有展会客户信息，并按优先级排序，这样我就可以快速识别重点客户并分配跟进任务。

**验收标准**:
- 以表格形式展示所有客户信息
- 包含字段：优先级、客户姓名、会面时间、会面地点、国家、手机号、邮箱、所属公司、公司官网、备注信息、微信二维码、WhatsApp二维码
- 默认按优先级降序排列（高优先级在前）
- 支持按任意字段排序和筛选
- 支持添加自定义字段（用于后续邮件个性化）
- 支持编辑、删除客户信息
- 支持导出为Excel格式

---

**Story 3: Excel表格批量导入客户**
> 作为一名销售经理，我希望能够直接上传Excel表格批量导入客户信息，这样我就可以快速将现有客户数据（如从其他系统导出的数据、展会名单等）录入系统，而不需要逐个手动输入或上传名片。

**验收标准**:
- 提供标准Excel模板下载
- 支持上传.xlsx格式文件，单次最多10,000条数据
- 自动识别Excel表头并映射到系统字段
- 支持手动调整字段映射关系
- 验证必填字段（客户姓名、邮箱）
- 验证邮箱和手机号格式
- 检测并提示重复数据（根据邮箱判断）
- 显示导入预览和错误提示
- 导入前需用户确认
- 显示导入结果统计（成功/失败/跳过数量）
- 支持导出错误数据报告和导入日志

---

**Story 4: 个性化批量邮件发送**
> 作为一名市场营销人员，我希望能够设计邮件模板，并根据客户信息自动替换个性化内容（如客户姓名、公司名），然后批量发送给筛选后的客户列表，这样我就可以高效地开展邮件营销活动。

**验收标准**:
- 提供可视化邮件模板编辑器（类似富文本编辑器）
- 支持插入动态字段（如：{{客户姓名}}、{{公司名称}}、{{国家}}、{{自定义字段1}}等）
- 支持插入自定义字段
- 可预览邮件效果（显示实际替换后的内容）
- 支持保存多个邮件模板
- 可从历史模板中选择复用

---

**Story 5: 精准客户筛选与发送**
> 作为一名销售经理，我希望能够根据优先级、国家、公司等条件筛选需要发送邮件的客户，并在发送过程中实时查看进度，这样我就可以精准触达目标客户并及时了解发送情况。

**验收标准**:
- 提供多条件筛选功能（优先级、国家、公司等）
- 显示筛选后的客户列表和总数
- 可手动勾选或取消勾选单个客户
- 显示实时发送进度：已发送数量 / 待发送数量 / 总数量
- 显示进度百分比和进度条
- 单个客户显示发送状态：成功（绿色）/ 失败（红色）/ 待发送（灰色）

---

**Story 6: 发送结果追踪与日志导出**
> 作为一名销售经理，我希望能够查看每封邮件的发送结果，了解失败原因，并导出发送日志用于分析和存档，这样我就可以优化邮件营销策略并进行后续跟进。

**验收标准**:
- 失败状态显示具体原因（如：邮箱不存在、服务器拒绝、网络超时等）
- 提供发送日志列表，显示：收件人、发送时间、发送状态、失败原因
- 支持导出发送日志为Excel格式
- 导出内容包括：收件人姓名、邮箱、公司、国家、优先级、邮件主题、所有动态字段值、发送状态、失败原因、发送时间

---

**Story 7: 产品目录Excel批量导入**
> 作为一名产品管理员，我希望能够通过上传Excel工作簿批量导入产品数据，包括产品图片，这样我就可以快速建立完整的产品目录，而不需要逐个手动录入。

**验收标准**:
- 支持上传.xlsx格式的Excel工作簿
- 自动识别每个工作表为一个品牌
- 自动提取Excel中嵌入的产品图片
- 图片以OE编号命名存储到资源文件夹
- 显示导入预览和结果统计
- 支持处理价格区间格式（如"65-75"）
- 导入失败的数据可下载错误报告

---

**Story 8: 产品智能报价**
> 作为一名销售人员，我希望能够根据产品数量、利润率、税率、FOB等条件自动计算推荐报价，并可手动调整最终报价，这样我就可以快速生成准确的报价单。

**验收标准**:
- 支持配置利润率（0%-50%）
- 支持含税/不含税切换（税率10%）
- 支持FOB价格模式（自动增加15%）
- 数量输入后自动应用阶梯利润率规则
- 实时显示推荐报价
- 支持手动覆盖最终报价
- 自动计算美元价格（根据汇率配置）

---

**Story 9: OE编号搜索报价**
> 作为一名销售人员，我希望能够通过输入OE编号快速搜索产品并添加到报价单，如果产品不存在也能创建记录，这样我就可以高效地处理客户询价。

**验收标准**:
- 支持输入单个或多个OE编号（逗号/换行分隔）
- 自动匹配数据库中的产品
- 匹配成功显示产品信息，可添加到报价列表
- 匹配失败生成空白记录，可填写备注
- 报价列表支持独立设置每个产品的报价参数
- 自动计算小计和总计
- 支持导出报价单

---

**Story 10: AI图片识别OE编号报价**
> 作为一名销售人员，我希望能够上传客户发来的聊天截图，系统自动识别其中的OE编号并匹配产品，这样我就可以更快速地响应客户询价，提高工作效率。

**验收标准**:
- 支持上传聊天截图（JPG、PNG格式）
- 调用豆包AI识别图片中的文本
- 自动提取可能的OE编号
- 显示识别结果和匹配状态
- 匹配成功的产品可批量添加到报价列表
- 未匹配的编号显示"未匹配"，可手动处理
- 报价列表复用标准报价功能

---

### 2.2 场景描述

**典型使用场景**:

**场景1: 展会期间快速收集**
1. 销售人员在展会现场与客户交流后收集名片
2. 使用手机拍摄名片照片
3. 在上传界面选择"批量上传名片"
4. 为每个客户标记优先级（根据沟通情况判断）
5. 系统自动识别并生成客户信息列表

**场景2: 展会后整理客户信息**
1. 销售经理登录系统查看所有展会客户
2. 系统自动按优先级排序显示
3. 逐个检查AI识别的信息准确性，必要时手动修正
4. 补充备注信息（如：客户需求、沟通重点等）
5. 导出Excel表格用于团队会议讨论

**场景3: Excel批量导入历史客户**
1. 销售经理从旧系统导出客户数据为Excel格式
2. 在系统中下载Excel导入模板
3. 参考模板调整Excel表格格式（调整列名、删除无用列）
4. 点击"导入客户"，上传整理好的Excel文件
5. 系统自动识别字段映射，销售经理检查并调整映射关系
6. 查看导入预览，发现有5条数据邮箱格式错误
7. 下载错误数据报告，修正后重新上传
8. 确认无误后执行导入
9. 查看导入结果：成功导入1,245条，跳过重复20条
10. 导出导入日志用于存档

**场景4: 第一轮邮件跟进**
1. 市场人员设计"展会感谢信"邮件模板
2. 在模板中插入动态字段：尊敬的{{客户姓名}}先生/女士，感谢您在{{会面地点}}的会面...
3. 保存模板为"展会感谢信模板"
4. 选择优先级为"高"的客户
5. 预览邮件效果，确认无误后批量发送
6. 实时查看发送进度
7. 发送完成后检查失败记录，手动处理失败客户

**场景5: 后续营销活动**
1. 销售经理策划新产品推广活动
2. 复用之前的邮件模板，修改为新产品介绍
3. 根据国家筛选目标市场客户（如：选择"德国"和"美国"）
4. 添加自定义字段"产品型号"用于个性化推荐
5. 批量发送并导出发送日志
6. 根据发送成功率优化邮箱质量

**场景6: 产品目录批量导入**
1. 产品管理员收到供应商发来的产品目录Excel表
2. 登录系统进入"产品管理-产品导入"页面
3. 上传Excel工作簿文件
4. 系统自动解析，显示各品牌工作表和产品数量预览
5. 确认后执行导入，系统自动提取产品图片
6. 图片以OE编号命名保存到资源文件夹
7. 查看导入结果：成功500条，失败3条（价格格式错误）
8. 下载错误报告，修正后重新导入

**场景7: 快速产品报价**
1. 销售人员收到客户询价，需要报3个产品的价格
2. 进入"产品管理-搜索报价"页面
3. 输入3个OE编号（逗号分隔）
4. 系统匹配到2个产品，1个未找到
5. 为未找到的产品填写备注"需确认是否有替代品"
6. 为匹配到的产品设置数量：第一个100件，第二个50件
7. 系统自动应用阶梯利润率（100件6%，50件10%）
8. 客户要求FOB价，开启FOB开关，系统自动计算
9. 查看最终报价，手动微调后导出报价单PDF发给客户

**场景8: AI识别聊天截图报价**
1. 销售人员收到客户微信发来的询价截图，包含多个产品编号
2. 进入"产品管理-搜索报价"页面，选择"AI识图"标签
3. 上传聊天截图
4. 系统调用豆包AI识别图片中的文本
5. 自动提取出5个可能的OE编号
6. 系统匹配到4个产品，1个未匹配
7. 销售人员将匹配的4个产品添加到报价列表
8. 对未匹配的编号查询后发现是错误编号，添加备注
9. 统一设置数量200件，系统自动应用3%利润率
10. 导出报价单Excel发给客户

---

## 3. 产品范围与功能列表 (Scope & Features)

### 3.0 产品架构说明

本产品采用**模块化平台架构**，设计理念如下：

- **前后端分离**: 便于多模块并行开发和独立部署
- **模块化设计**: 每个业务模块独立，数据互通但功能解耦
- **可扩展性**: 预留接口和数据结构，支持快速添加新模块
- **统一基础服务**: 用户认证、权限管理、文件存储等基础服务由平台层统一提供

**本期（MVP）开发范围**:
- ✅ 平台基础框架（用户系统、导航框架、基础UI组件）
- ✅ 客户管理模块（完整功能）
- ✅ 邮件营销模块（完整功能）
- ✅ 产品管理模块（完整功能）
- ✅ 前端预留其他模块入口（展示产品规划）

**本期不开发但需预留**:
- 🔲 其他业务模块（销售、物流、供应链等）的具体功能
- 🔲 团队协作功能（多人权限、数据隔离）
- 🔲 高级数据分析功能

---

### 3.1 本期功能范围 (In Scope)

#### 3.1.1 名片识别与客户管理模块

**功能点1: 名片上传与识别**
- 支持单张/批量上传名片图片（支持格式：JPG, PNG, HEIC）
- 每张名片可设置优先级（1-5星或高/中/低）
- AI自动识别名片信息：姓名、公司、职位、电话、邮箱、地址、网站
- 识别微信二维码和WhatsApp二维码并保存为图片字段
- 支持手动校正识别结果
- 显示识别置信度（可选，用于提示用户检查）

**功能点2: 客户信息表格**
- 表格字段：
  - 系统字段：优先级、客户姓名、会面时间、会面地点、国家、手机号、邮箱、所属公司、公司官网、备注信息
  - 图片字段：微信二维码、WhatsApp二维码
  - 自定义字段：用户可添加任意文本字段
- 按优先级降序排列（默认）
- 支持按任意字段排序
- 支持多条件筛选（优先级、国家、公司、时间范围等）
- 支持关键词搜索（姓名、公司、邮箱）
- 支持单条/批量编辑、删除
- 支持导出为Excel格式

**功能点3: 自定义字段管理**
- 支持添加自定义文本字段
- 字段可用于邮件模板中的动态替换
- 支持批量填充自定义字段值

**功能点4: Excel表格批量导入客户**

除了通过名片识别录入客户，系统还需支持直接上传Excel表格批量导入客户信息，适用于已有客户数据的场景。

**导入流程**:
1. **下载Excel模板**
   - 提供标准Excel模板下载
   - 模板包含所有系统字段列（优先级、客户姓名、会面时间、会面地点、国家、手机号、邮箱、所属公司、公司官网、备注信息等）
   - 模板包含字段说明和填写示例
   - 支持自定义字段列（用户可在模板中添加自定义列）

2. **上传Excel文件**
   - 支持上传.xlsx格式文件
   - 文件大小限制：≤ 10MB
   - 单次最多导入10,000条客户数据

3. **智能字段映射**
   - 自动识别Excel表头与系统字段的对应关系
   - 支持模糊匹配（如"姓名"、"客户名称"、"Name"都可映射到"客户姓名"字段）
   - 用户可手动调整字段映射关系
   - 显示映射预览：Excel列名 → 系统字段名

4. **数据验证与清洗**
   - 必填字段检查：客户姓名、邮箱必填
   - 格式验证：
     - 邮箱格式验证（正则表达式）
     - 手机号格式验证（支持国际格式）
     - 日期格式自动识别和转换
   - 重复数据检测：
     - 根据邮箱判断是否为重复客户
     - 提示重复数据处理方式：跳过 / 覆盖 / 合并
   - 数据清洗：
     - 去除首尾空格
     - 统一日期格式
     - 清理特殊字符

5. **导入预览与确认**
   - 显示导入数据预览（前50条）
   - 显示数据统计：
     - 总行数
     - 有效数据数量
     - 错误数据数量（标红显示）
   - 错误提示：逐行显示错误原因（如"第5行：邮箱格式错误"）
   - 支持下载错误数据报告（Excel格式）
   - 用户确认后执行导入

6. **导入结果反馈**
   - 显示导入进度条
   - 显示导入结果统计：
     - 成功导入：X条
     - 跳过（重复）：X条
     - 失败：X条
   - 支持导出导入日志（Excel格式）

**字段映射规则**:

| Excel可能的列名 | 系统字段 | 是否必填 |
|----------------|---------|---------|
| 姓名/客户姓名/Name/Customer Name | 客户姓名 | ✅ 必填 |
| 邮箱/Email/电子邮件 | 邮箱 | ✅ 必填 |
| 公司/公司名称/Company | 所属公司 | - |
| 手机/电话/Phone/Mobile | 手机号 | - |
| 网站/官网/Website | 公司官网 | - |
| 国家/Country | 国家 | - |
| 地点/会面地点/Location | 会面地点 | - |
| 时间/会面时间/Date | 会面时间 | - |
| 优先级/Priority/等级 | 优先级 | - |
| 备注/Remark/Notes | 备注信息 | - |

**特殊处理**:
- **优先级映射**：支持多种输入格式
  - 数字：1-5（1=最高）
  - 星级：★★★★★ / 5星
  - 文本：高/中/低 → 自动转换为数字
- **日期识别**：自动识别多种日期格式
  - 2025-12-02
  - 2025/12/02
  - 12/02/2025
  - 2025年12月2日
- **国家名称标准化**：
  - 支持中英文国家名（如"美国"/"USA"/"United States"统一为"美国"）
  - 提供国家下拉列表供选择

**错误处理**:
- 邮箱格式错误：标记错误，不导入该行
- 邮箱重复：根据用户设置（跳过/覆盖/合并）
- 必填字段缺失：标记错误，不导入该行
- 日期格式无法识别：留空或提示用户修改
- 优先级格式错误：默认设置为"中"

**导入模式**:
- **追加模式**：新增客户，不影响现有数据（默认）
- **覆盖模式**：根据邮箱匹配，覆盖已有客户信息
- **合并模式**：根据邮箱匹配，仅更新非空字段

---

#### 3.1.2 邮件营销模块

**功能点5: 可视化邮件模板编辑器**
- 富文本编辑功能：字体、字号、颜色、加粗、斜体、下划线、列表、对齐等
- 支持插入图片（上传或URL）
- 支持插入动态字段（下拉选择：{{客户姓名}}、{{公司名称}}等）
- 支持插入自定义字段
- 实时预览功能（选择某个客户数据预览实际效果）
- 邮件主题支持动态字段

**功能点6: 邮件模板管理**
- 保存邮件模板（模板名称、主题、正文）
- 模板列表展示（名称、创建时间、最后使用时间）
- 复用历史模板
- 编辑、删除模板

**功能点7: 客户筛选与发送**
- 多条件筛选器：优先级、国家、公司、时间范围、自定义字段
- 显示筛选结果列表和总数
- 支持手动勾选/取消勾选客户
- 全选/反选功能
- 发送前二次确认（显示收件人数量）

**功能点8: 实时发送进度追踪**
- 显示发送进度条和百分比
- 显示统计：已发送 / 待发送 / 总数量
- 客户列表实时更新状态：
  - 待发送（灰色，图标：⏳）
  - 发送成功（绿色，图标：✓）
  - 发送失败（红色，图标：✗）
- 失败状态显示原因（如：邮箱不存在、服务器拒绝、网络超时、邮箱格式错误等）
- 支持暂停/继续发送
- 发送失败的客户支持重新发送

**功能点9: 发送日志管理**
- 发送日志列表：发送时间、模板名称、收件人数量、成功数量、失败数量
- 点击查看详情：每个收件人的发送状态
- 导出发送日志为Excel格式：
  - 包含字段：收件人姓名、邮箱、公司、国家、优先级、手机号、所有自定义字段值、邮件主题、发送状态、失败原因、发送时间
- 日志保留时间：至少6个月

---

#### 3.1.3 产品管理模块

本模块用于管理卡车配件产品目录，支持从Excel批量导入产品数据，并提供智能报价功能。

**功能点10: Excel产品数据批量导入**

支持从Excel工作簿批量导入产品数据，每个品牌为独立工作表。

**Excel表格结构要求**:
- 工作簿结构：每个品牌一个工作表（Sheet），工作表名为品牌完整名称
- 第一行：品牌缩写（如：MB、VL、SC等）
- 表头字段：
  | Excel列名 | 系统字段 | 说明 | 是否必填 |
  |-----------|---------|------|---------|
  | NO. | - | 序号（不导入） | - |
  | XK NO. | 内部编号 | 公司内部产品编号 | ✅ 必填 |
  | OE NO. | OE编号 | 国际通用OE编号 | ✅ 必填 |
  | PICTURE | 产品图片 | Excel嵌入图片 | - |
  | 售价/出厂价 | 出厂价（人民币） | 产品出厂价格 | ✅ 必填 |
  | 备注 | 备注信息 | 产品备注 | - |

**图片处理**:
- 自动提取Excel中嵌入的图片（DISPIMG格式）
- 图片以OE编号命名，存储到独立资源文件夹：`/uploads/products/{品牌}/{OE编号}.jpg`
- 支持的图片格式：JPG、PNG
- 自动去除OE编号中的特殊字符（如斜杠/）作为文件名

**导入流程**:
1. 上传Excel工作簿文件（.xlsx格式）
2. 系统解析所有工作表，显示品牌列表预览
3. 用户确认后执行导入
4. 显示导入结果：成功数量、失败数量、跳过数量
5. 支持导出导入日志和错误报告

**数据校验**:
- XK NO. 和 OE NO. 必填校验
- 出厂价格格式校验（数字或价格区间如"65-75"）
- 重复数据检测（根据OE编号判断）
- 价格区间自动解析（取平均值或最高值，可配置）

---

**功能点11: 产品目录展示**

以目录形式展示所有产品，支持按品牌分类浏览和多条件筛选。

**页面布局**:
- 左侧：品牌分类导航（显示各品牌产品数量）
- 右侧：产品列表（表格或卡片视图可切换）

**产品列表字段**:
| 字段名 | 说明 |
|--------|------|
| 产品图片 | 缩略图展示，点击可放大 |
| XK NO. | 内部编号 |
| OE NO. | OE编号（支持复制） |
| 品牌 | 所属品牌 |
| 出厂价（RMB） | 人民币出厂价 |
| 出厂价（USD） | 美元价格（自动换算） |
| 推荐报价（USD） | 根据配置计算的推荐报价 |
| 备注 | 产品备注信息 |
| 操作 | 添加到报价单 |

**汇率配置**:
- 系统设置中配置人民币对美元汇率（默认7.2）
- 支持手动更新或对接汇率API自动更新

**筛选与搜索**:
- 按品牌筛选
- 按OE编号搜索（支持模糊搜索）
- 按XK编号搜索
- 按价格区间筛选

---

**功能点12: 智能报价计算器**

提供灵活的报价配置，根据多种因素自动计算推荐报价和最终报价。

**报价参数配置**:

| 参数 | 说明 | 默认值 | 配置范围 |
|------|------|--------|---------|
| 利润率 | 产品利润率 | 动态计算 | 0%-50% |
| 含税 | 是否含税 | 否 | 是/否 |
| 税率 | 增值税税率 | 10% | 固定 |
| FOB | FOB价格模式 | 否 | 是/否 |
| FOB费率 | FOB附加费率 | 15% | 固定 |
| 数量 | 产品数量 | 1 | 1-9999 |

**数量阶梯利润率规则**:
| 数量区间 | 默认利润率 |
|---------|-----------|
| 1-99 | 10% |
| 100-199 | 6% |
| 200-499 | 3% |
| ≥500 | 0% |

**价格计算公式**:

```
基础价格 = 出厂价（RMB） ÷ 汇率 = 出厂价（USD）

利润加成 = 基础价格 × (1 + 利润率)

税费计算:
- 如果含税: 含税价格 = 利润加成 × (1 + 税率)
- 如果不含税: 含税价格 = 利润加成

FOB计算:
- 如果选择FOB: FOB价格 = 含税价格 × (1 + FOB费率)
- 注意: 选择FOB时自动切换为不含税

最终报价 = 单价 × 数量

推荐报价 = 根据当前配置自动计算
最终报价 = 用户可手动调整后的价格
```

**交互设计**:
- 利润率滑块（0%-50%）+ 数字输入框
- 含税/不含税切换按钮
- FOB开关（开启后自动禁用含税选项）
- 数量输入框（输入数量后自动调整利润率）
- 实时显示推荐报价
- 支持用户手动覆盖最终报价

---

**功能点13: OE编号搜索报价**

通过OE编号快速搜索产品并生成报价单。

**基础搜索功能**:
- 输入OE编号（支持多个，以逗号或换行分隔）
- 系统自动匹配数据库中的产品
- 匹配成功：显示产品信息，可添加到报价列表
- 匹配失败：生成空白记录，标注"未找到"，用户可手动填写备注

**报价列表**:
- 支持添加多个产品
- 每个产品可独立设置数量和报价参数
- 自动计算小计和总计
- 支持删除、调整顺序
- 复用功能点12的报价计算逻辑

**报价列表字段**:
| 字段 | 说明 |
|------|------|
| 序号 | 自动编号 |
| 产品图片 | 缩略图 |
| XK NO. | 内部编号 |
| OE NO. | OE编号 |
| 品牌 | 所属品牌 |
| 出厂价（USD） | 美元出厂价 |
| 数量 | 产品数量（可编辑） |
| 利润率 | 当前利润率（可编辑） |
| 含税/FOB | 价格模式（可编辑） |
| 推荐单价 | 系统推荐单价 |
| 最终单价 | 用户确认的单价（可编辑） |
| 小计 | 单价 × 数量 |
| 备注 | 产品备注 |
| 操作 | 删除 |

**汇总信息**:
- 产品总数
- 总金额（USD）
- 平均利润率

---

**功能点14: AI图片识别OE编号（高阶功能）**

集成豆包AI（字节跳动）图像识别API，从聊天截图中自动提取OE编号。

**应用场景**:
- 客户通过微信、WhatsApp等发送产品询价截图
- 截图中包含产品OE编号
- 系统自动识别并匹配产品

**功能流程**:
1. **图片上传**: 用户上传聊天截图（支持JPG、PNG格式）
2. **AI识别**: 调用豆包AI识图API，提取图片中的文本
3. **OE编号提取**: 使用正则表达式从文本中提取可能的OE编号
4. **产品匹配**: 
   - 匹配成功：显示产品信息，可添加到报价列表
   - 匹配失败：显示可能的OE编号，标注"未匹配"，供用户确认
5. **批量添加**: 用户选择需要的产品，批量添加到报价列表

**识别结果展示**:
| 识别内容 | 匹配状态 | 产品信息 | 操作 |
|---------|---------|---------|------|
| 9588201061 | ✅ 已匹配 | XK-MB-001 / 奔驰 | 添加到报价单 |
| 9408200361 | ✅ 已匹配 | XK-MB-003 / 奔驰 | 添加到报价单 |
| 1234567890 | ❌ 未匹配 | - | 手动添加 |

**技术实现**:
- 集成豆包AI大模型视觉理解API
- API调用频率限制：单用户每分钟最多10次
- 图片大小限制：≤ 5MB
- 支持的图片格式：JPG、PNG、WebP

**代码复用**:
- 报价列表展示逻辑与功能点13共用
- 报价计算逻辑与功能点12共用
- 统一的报价单组件，支持不同入口调用

---

**功能点15: 报价单导出**

支持将报价列表导出为Excel格式，格式简洁专业。

**导出格式**: Excel格式（.xlsx）

**导出样式**:

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│           PRICE QUOTATION --2025.12.3                       │
│                                                             │
├─────┬────────────┬─────────────┬──────────┬────────────────┤
│ NO. │   XK NO.   │   OE NO.    │ PICTURE  │  UNIT PRICE    │
├─────┼────────────┼─────────────┼──────────┼────────────────┤
│  1  │ XK-MB-037  │ 9738202661  │  [图片]  │    $XX.XX      │
├─────┼────────────┼─────────────┼──────────┼────────────────┤
│  2  │ XK-MB-001  │ 9588201061  │  [图片]  │    $XX.XX      │
├─────┼────────────┼─────────────┼──────────┼────────────────┤
│ ... │    ...     │    ...      │   ...    │     ...        │
└─────┴────────────┴─────────────┴──────────┴────────────────┘
```

**导出内容**:

| 列名 | 说明 |
|------|------|
| NO. | 序号（自动编号，从1开始） |
| XK NO. | 公司内部编号 |
| OE NO. | 国际通用OE编号 |
| PICTURE | 产品图片（嵌入Excel单元格） |
| UNIT PRICE | 最终单价（USD） |

**标题格式**:
- 标题：`PRICE QUOTATION --{当前日期}`
- 日期格式：`YYYY.MM.DD`（如：2025.12.3）
- 标题居中显示，字号加大加粗

**样式要求**:
- 表头行：背景色浅灰，字体加粗
- 数据行：白底，细边框
- 图片列：自动调整行高以适应图片尺寸
- 图片尺寸：等比例缩放，宽度约100-150px
- 价格列：右对齐，保留2位小数，带美元符号

**技术实现**:
- 使用Apache POI（Java）或openpyxl（Python）生成Excel
- 图片以嵌入方式插入单元格
- 自动调整列宽以适应内容

---

#### 3.1.4 系统基础功能

**功能点16: 系统导航与布局（重点）**

本系统采用**模块化设计**，前端需为未来功能模块预留位置，展示产品完整规划。

**侧边栏导航菜单结构**:

```
📊 工作台（Dashboard）
  └─ 数据概览、待办事项、快捷入口 [即将推出]

👥 客户管理 [✓ 本期开发]
  ├─ 名片识别与录入
  ├─ Excel批量导入
  ├─ 客户信息表格
  └─ 客户详情页

📧 邮件营销 [✓ 本期开发]
  ├─ 邮件模板管理
  ├─ 批量发送
  └─ 发送日志

📦 产品管理 [✓ 本期开发]
  ├─ 产品导入（Excel批量导入）
  ├─ 产品目录
  ├─ 搜索报价
  └─ 报价单生成

💼 销售管理 [即将推出]
  ├─ 报价单管理
  ├─ 合同管理
  ├─ 订单管理
  └─ 销售漏斗

🚚 物流跟踪 [即将推出]
  ├─ 订单物流
  ├─ 货运追踪
  └─ 清关进度

📦 供应链管理 [即将推出]
  ├─ 供应商管理
  ├─ 采购管理
  └─ 库存管理

📄 文档中心 [即将推出]
  ├─ 合同文档
  ├─ 发票管理
  └─ 证书归档

📈 数据分析 [即将推出]
  ├─ 销售报表
  ├─ 客户分析
  └─ 业务预测

⚙️ 系统设置
  ├─ 个人资料
  ├─ 账号安全
  ├─ 邮箱配置 [✓ 本期开发]
  └─ 团队管理 [即将推出]
```

**实现要求**:
- ✅ 所有菜单项在侧边栏可见，但未开发模块标记"即将推出"并置灰
- ✅ 点击未开发模块时，弹出提示："此功能即将推出，敬请期待！"
- ✅ 提供"功能路线图"入口，展示各模块的预计上线时间
- ✅ 支持侧边栏收起/展开功能
- ✅ 当前激活模块高亮显示

**顶部导航栏**:
- 左侧：Logo + 产品名称"TruckTools - 卡车外贸工具平台"
- 中间：全局搜索框（本期仅支持搜索客户信息）
- 右侧：通知中心、帮助文档、用户头像下拉菜单（个人中心、退出登录）

**前端界面布局示意**:

```
┌────────────────────────────────────────────────────────────┐
│  🚚 TruckTools        [🔍 搜索...]      🔔  ❓  👤          │
├──────────┬─────────────────────────────────────────────────┤
│          │                                                  │
│ 📊 工作台 │  页面内容区域                                      │
│   🔒     │  (本期显示"即将推出"占位页)                        │
│          │                                                  │
│ 👥客户管理│                                                  │
│   ✓     │                                                  │
│          │                                                  │
│ 📧邮件营销│                                                  │
│   ✓     │                                                  │
│          │                                                  │
│ 📦产品管理│                                                  │
│   ✓     │                                                  │
│          │                                                  │
│ 💼销售管理│                                                  │
│   🔒     │                                                  │
│          │                                                  │
│ 🚚物流跟踪│                                                  │
│   🔒     │                                                  │
│          │                                                  │
│ 📦供应链  │                                                  │
│   🔒     │                                                  │
│          │                                                  │
│ 📄文档中心│                                                  │
│   🔒     │                                                  │
│          │                                                  │
│ 📈数据分析│                                                  │
│   🔒     │                                                  │
│          │                                                  │
│ ⚙️设置   │                                                  │
│   ✓     │                                                  │
│          │                                                  │
└──────────┴─────────────────────────────────────────────────┘

图例: ✓ 本期开发   🔒 即将推出
```

**"即将推出"模块的占位页设计**:

当用户点击未开发模块时，显示占位页：

```
┌─────────────────────────────────────┐
│                                     │
│          🚧                         │
│                                     │
│      此功能即将推出                  │
│                                     │
│   我们正在努力开发此功能，           │
│   预计在 [X月] 上线，敬请期待！      │
│                                     │
│   想了解更多？查看 [功能路线图]      │
│                                     │
└─────────────────────────────────────┘
```

---

**功能点17: 数据导出**
- 支持导出客户信息为Excel格式
- 支持导出发送日志为Excel格式
- 支持导出产品报价单为Excel/PDF格式
- 导出时可选择导出字段
- 支持按筛选条件导出部分数据

**功能点18: 功能路线图页面（展示产品规划）**

为了让用户了解产品的完整规划和各模块的上线时间，需要提供一个"功能路线图"页面。

**页面内容**:
- 以时间轴形式展示各模块的规划上线时间
- 每个模块显示：模块名称、核心功能简介、预计上线时间、当前状态
- 支持用户"投票"或"留言"表达对某个功能的需求
- 入口：侧边栏底部 + 占位页中的"查看功能路线图"链接

**路线图示例**:

```
2025 Q4 ────────────────────────────────────────
  ✅ 客户管理模块  [已上线]
  ✅ 邮件营销模块  [已上线]
  ✅ 产品管理模块  [已上线]
     - 产品目录与分类
     - 智能报价计算
     - OE编号搜索
     - AI图片识别报价

2026 Q1 ────────────────────────────────────────
  🚧 邮件追踪增强  [开发中]
  📅 客户标签系统  [计划中]
  📅 移动端H5适配  [计划中]

2026 Q2 ────────────────────────────────────────
  📅 销售管理模块  [计划中]
     - 报价单管理
     - 合同管理
     - 订单管理
     - 销售漏斗

2026 Q3-Q4 ─────────────────────────────────────
  📅 物流跟踪模块  [规划中]
  📅 供应链管理   [规划中]
  📅 文档中心     [规划中]

2027 年 ────────────────────────────────────────
  📅 数据分析模块  [规划中]
  📅 AI智能助手   [规划中]
  📅 移动端APP    [规划中]

图例: ✅ 已上线  🚧 开发中  📅 计划中
```

**实现要求**:
- 路线图数据可在后台配置（CMS方式）
- 支持用户订阅模块上线通知（邮件提醒）
- 显示各模块的"感兴趣"人数统计

---

### 3.2 本期不包含的功能 (Out of Scope)

以下功能不在本期开发范围内，将在后续版本中考虑：

- 邮件打开率、点击率追踪（需要嵌入追踪像素）
- 邮件回复自动分类和提醒
- 客户标签系统和客户画像
- CRM完整功能（跟进记录、销售漏斗、商机管理等）
- 订单管理模块
- 物流跟踪模块
- 供应链管理模块
- 文档中心模块
- 数据分析模块（仅保留基础的客户列表统计）
- 多语言支持（本期仅支持中文界面）
- 移动端APP（本期仅支持Web端H5响应式）
- 团队协作功能（客户分配、权限管理等）
- AI客户推荐和商机预测
- 第三方系统集成（ERP、物流平台等）

---

### 3.3 平台架构与模块化设计

#### 3.3.1 平台架构图

```
┌───────────────────────────────────────────────────────────────┐
│                     用户界面层 (UI Layer)                       │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐         │
│  │ 客户管理 │ │ 产品管理 │ │ 销售管理 │ │ 物流跟踪 │         │
│  │   [✓]   │ │   [✓]   │ │  [预留]  │ │  [预留]  │         │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘         │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐         │
│  │ 邮件营销 │ │ 文档中心 │ │ 数据分析 │ │ 系统设置 │         │
│  │   [✓]   │ │  [预留]  │ │  [预留]  │ │   [✓]   │         │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘         │
└───────────────────────────────────────────────────────────────┘
                              ↓
┌───────────────────────────────────────────────────────────────┐
│                   平台基础服务层 (Platform Layer)               │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐                │
│  │ 用户认证   │ │ 权限管理   │ │ 消息通知   │                │
│  │ (Auth)    │ │ (RBAC)    │ │ (Notice)  │                │
│  └────────────┘ └────────────┘ └────────────┘                │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐                │
│  │ 文件存储   │ │ 任务队列   │ │ 日志监控   │                │
│  │ (Storage) │ │ (Queue)   │ │ (Log)     │                │
│  └────────────┘ └────────────┘ └────────────┘                │
└───────────────────────────────────────────────────────────────┘
                              ↓
┌───────────────────────────────────────────────────────────────┐
│                    业务逻辑层 (Business Layer)                  │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐ │
│  │ 客户服务   │ │ 邮件服务   │ │ OCR服务    │ │ 产品服务   │ │
│  │ [✓]       │ │ [✓]       │ │ [✓]       │ │ [✓]       │ │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘ │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐ │
│  │ 订单服务   │ │ 物流服务   │ │ 数据服务   │ │ AI识图服务 │ │
│  │ [预留]    │ │ [预留]    │ │ [预留]    │ │ [✓]       │ │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘ │
└───────────────────────────────────────────────────────────────┘
                            ↓
┌─────────────────────────────────────────────────────────┐
│                     数据访问层 (Data Layer)               │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐          │
│  │ 关系数据库 │ │ 对象存储   │ │ 缓存服务   │          │
│  │ (MySQL)   │ │ (OSS)     │ │ (Redis)   │          │
│  └────────────┘ └────────────┘ └────────────┘          │
└─────────────────────────────────────────────────────────┘
```

#### 3.3.2 模块化设计原则

**1. 模块独立性**
- 每个业务模块拥有独立的前端路由和页面组件
- 模块间通过平台基础服务进行数据交互
- 单个模块的上线/下线不影响其他模块

**2. 数据互通性**
- 采用统一的数据模型和API规范
- 客户数据可被多个模块共享（客户管理、销售管理、邮件营销等）
- 提供跨模块的数据关联（如：客户 → 订单 → 物流）

**3. 界面一致性**
- 统一的UI组件库（基于Ant Design或Element Plus）
- 统一的交互规范和视觉风格
- 统一的侧边栏导航和页面布局

**4. 可扩展性**
- 预留数据库字段和API接口
- 支持插件式功能扩展
- 前端采用动态路由，方便添加新模块

#### 3.3.3 本期开发的技术架构要求

**前端技术栈**:
- 框架: Vue 3 + TypeScript 或 React 18 + TypeScript
- UI组件: Ant Design / Element Plus / Arco Design
- 状态管理: Pinia (Vue) / Redux Toolkit (React)
- 路由: Vue Router / React Router（支持动态路由配置）
- 构建工具: Vite

**后端技术栈**:
- 语言: Python (Django/FastAPI) 或 Node.js (NestJS)
- 数据库: MySQL 8.0+ / PostgreSQL
- 缓存: Redis
- 对象存储: 阿里云OSS / 腾讯云COS / AWS S3
- 任务队列: Celery / Bull

**关键设计要求**:
- ✅ 前端采用**模块化路由配置**，便于后续添加新模块
- ✅ 后端采用**微服务或模块化单体架构**，每个业务模块独立service
- ✅ 数据库设计预留**扩展字段**（如：JSON类型的extra_data字段）
- ✅ API设计遵循**RESTful规范**，版本化管理（/api/v1/）

---

## 4. 产品特定AI需求

### 4.1 模型需求

#### 4.1.1 名片OCR识别模型

**功能要求**:
- 识别名片图片中的文本信息
- 结构化输出：姓名、公司、职位、电话、邮箱、地址、网站等字段
- 识别并提取微信二维码和WhatsApp二维码图片
- 支持多语言名片（英语、中文、日语、韩语、德语、法语、西班牙语等）
- 支持倾斜、模糊、光线不佳等非理想拍摄条件

**性能指标**:
- 识别准确率：≥ 90%（关键字段如姓名、邮箱、电话）
- 识别速度：单张名片 ≤ 3秒
- 字段提取准确率：≥ 85%（正确分类到对应字段）
- 二维码识别准确率：≥ 95%

**模型选型建议**:
- 方案1：使用商业OCR API（如：百度OCR、腾讯OCR、阿里云OCR）+ 自研字段分类模型
- 方案2：使用开源OCR引擎（如：PaddleOCR、Tesseract）+ 微调的NER模型进行字段提取
- 方案3：使用多模态大模型（如：GPT-4V、Claude Vision）进行端到端名片信息提取

**推荐方案**: 方案1（商业API + 轻量级分类模型）
- 优势：快速上线，准确率有保障，无需大量训练数据
- 劣势：单张成本较高（约0.01-0.05元/张）

---

#### 4.1.2 邮件内容动态字段替换

**功能要求**:
- 解析邮件模板中的动态字段（如：{{客户姓名}}）
- 根据客户数据替换为实际值
- 支持条件渲染（如：根据国家显示不同货币）
- 支持默认值（如：客户姓名为空时显示"尊敬的客户"）

**性能指标**:
- 替换准确率：100%（不允许出现未替换的字段）
- 处理速度：1000个客户 ≤ 10秒

**实现方案**:
- 使用模板引擎（如：Jinja2、Handlebars）进行字段替换
- 不需要AI模型，采用规则引擎即可

---

#### 4.1.3 豆包AI图像识别（OE编号提取）

**功能要求**:
- 识别聊天截图中的文本内容
- 从识别文本中提取可能的OE编号（产品编号格式）
- 支持多种图片格式和质量

**应用场景**:
- 客户通过即时通讯工具（微信、WhatsApp等）发送产品询价截图
- 截图中包含产品编号、型号等信息
- 自动识别并匹配系统中的产品数据

**技术选型**:
- 方案1：豆包AI大模型视觉理解API（推荐）
  - 优势：识别准确率高，支持复杂场景，国内服务稳定
  - 成本：按调用次数计费
- 方案2：百度OCR + 正则表达式提取
  - 优势：成本较低
  - 劣势：复杂场景识别效果较差

**性能指标**:
- 文本识别准确率：≥ 95%
- OE编号提取准确率：≥ 90%
- 单张图片处理时间：≤ 5秒
- 图片大小限制：≤ 5MB

**OE编号提取规则**:
- 正则表达式匹配：数字为主的编号（如：9588201061、9408200361/9408200161）
- 支持识别带有斜杠的多编号格式
- 过滤常见干扰项（日期、电话号码等）

**API调用限制**:
- 单用户每分钟最多10次调用
- 日调用上限：1000次/用户
- 超出限制时提示用户稍后重试

**隐私与安全**:
- 用户上传的图片仅用于识别，不做存储
- 识别完成后立即删除原图
- 符合数据隐私保护要求

---

#### 4.1.4 Excel嵌入图片提取

**功能要求**:
- 从Excel文件中提取嵌入的图片（DISPIMG格式）
- 自动关联图片与对应行的OE编号
- 以OE编号命名保存图片文件

**技术实现**:
- Excel文件本质为ZIP压缩包
- 图片存储在 `xl/media/` 目录下
- 通过解析 `xl/drawings/` 中的关系文件确定图片与单元格的对应关系
- 使用Python的openpyxl或xlrd库处理

**处理流程**:
1. 解压xlsx文件
2. 读取 `xl/media/` 目录获取所有图片
3. 解析 `xl/drawings/drawing*.xml` 获取图片位置
4. 关联图片与单元格行号
5. 根据OE编号重命名并保存图片

**存储规则**:
- 存储路径：`/uploads/products/{品牌缩写}/{OE编号}.jpg`
- 文件名处理：去除OE编号中的斜杠、空格等特殊字符
- 图片格式统一转换为JPG（保持原始质量）

**性能指标**:
- 单个Excel文件处理时间：≤ 30秒（包含100张图片）
- 图片提取成功率：≥ 99%

---

### 4.2 数据需求

#### 4.2.1 训练数据需求（如使用自研模型）

**名片OCR训练数据**:
- 数据来源：公开名片数据集 + 众包标注 + 用户授权的真实名片数据
- 数据数量：至少10,000张标注名片（涵盖不同国家、行业、语言）
- 数据质量要求：
  - 标注准确率 ≥ 98%
  - 包含多种拍摄条件（正常、倾斜、模糊、反光等）
  - 覆盖主流名片版式
- 标注内容：边界框 + 文本内容 + 字段分类

**字段分类训练数据**:
- 数据来源：从OCR结果中提取的文本行 + 字段标签
- 数据数量：至少50,000条标注样本
- 标注标签：姓名、公司、职位、电话、邮箱、地址、网站、其他

---

#### 4.2.2 用户数据隐私与安全

**数据存储**:
- 名片图片：加密存储，仅用户本人可访问
- 客户信息：加密存储，遵循GDPR和个人信息保护法
- 发送日志：保留6个月后自动删除或匿名化

**数据使用授权**:
- 用户上传名片时需同意隐私政策
- 明确告知数据用途（OCR识别、存储、展示）
- 用户可随时删除数据
- 如用于模型训练，需单独获取授权并脱敏处理

---

### 4.3 算法边界与可解释性

#### 4.3.1 识别失败处理

**边界情况**:
- 名片完全空白或无法识别：提示用户重新上传
- 非名片图片（如风景照）：提示"未识别到名片信息"
- 识别置信度过低（< 60%）：标记为"需人工审核"，提示用户检查

**人工介入机制**:
- 所有识别结果均可手动编辑
- 识别失败的名片可手动录入
- 提供"报告识别错误"功能，用于模型优化

---

#### 4.3.2 可解释性

**OCR识别结果可视化**:
- 在名片图片上高亮显示识别区域
- 显示每个字段的置信度
- 用户可点击查看原始识别文本与结构化字段的对应关系

---

### 4.4 评估标准

#### 4.4.1 OCR模型评估指标

- **字符识别准确率** (Character Accuracy): ≥ 95%
- **字段提取准确率** (Field Extraction Accuracy): ≥ 85%
  - 姓名准确率: ≥ 90%
  - 邮箱准确率: ≥ 95%
  - 电话准确率: ≥ 90%
  - 公司名准确率: ≥ 85%
- **二维码识别准确率** (QR Code Detection): ≥ 95%
- **识别速度** (Latency): ≤ 3秒/张

**评估方法**:
- 准备测试集：1000张真实名片（涵盖不同国家、语言、版式）
- 人工标注标准答案
- 计算模型输出与标准答案的一致性
- 每季度重新评估一次

---

#### 4.4.2 产品功能评估指标

- **用户任务完成率**: ≥ 95%（用户能否顺利完成名片上传、邮件发送等核心任务）
- **识别结果满意度**: ≥ 80%（用户对OCR识别准确性的满意度）
- **邮件发送成功率**: ≥ 95%（排除无效邮箱后的发送成功率）
- **系统响应时间**: ≤ 2秒（常规操作如页面加载、表格刷新）

---

### 4.5 伦理与合规

#### 4.5.1 隐私保护

- **最小化数据收集**: 仅收集业务必需的名片信息，不收集敏感信息（如种族、宗教信仰等）
- **用户知情同意**: 上传名片前明确告知数据用途和存储方式
- **数据删除权**: 用户可随时删除客户信息和名片图片
- **访问控制**: 用户仅能访问自己上传的数据，无法访问其他用户数据

---

#### 4.5.2 数据安全

- **传输加密**: 所有数据传输使用HTTPS/TLS加密
- **存储加密**: 敏感字段（邮箱、电话）加密存储
- **访问日志**: 记录所有数据访问和修改操作，可追溯
- **定期备份**: 每日自动备份数据，保留30天

---

#### 4.5.3 合规要求

- **GDPR合规**: 如服务欧洲客户，需符合GDPR要求（数据主体权利、数据跨境传输等）
- **反垃圾邮件法**: 发送商业邮件需遵循各国反垃圾邮件法规：
  - 收件人需有合法的邮件接收意愿（如展会名片交换视为软同意）
  - 邮件需包含退订链接（本期可暂不实现，但需在后续版本中补充）
  - 发件人信息真实有效
- **数据本地化**: 如服务中国市场，需将数据存储在中国境内服务器

---

#### 4.5.4 AI伦理

- **算法偏见**: 确保OCR模型对不同国家、语言的名片识别准确率无显著差异
- **透明度**: 向用户说明AI识别的局限性，建议用户检查识别结果
- **人类监督**: 关键决策（如批量删除客户）需人工确认，不自动执行

---

## 5. 非功能性需求 (性能、安全、可用性等)

### 5.1 性能需求

#### 5.1.1 响应时间

- **页面加载时间**: ≤ 2秒（首屏加载，正常网络环境）
- **名片识别时间**: ≤ 3秒/张（单张），≤ 5秒/张（批量上传时的平均速度）
- **Excel客户导入处理时间**: 
  - 1,000条数据 ≤ 10秒
  - 5,000条数据 ≤ 30秒
  - 10,000条数据 ≤ 60秒
- **Excel产品导入处理时间**: 
  - 含100张图片的Excel ≤ 30秒
  - 含500张图片的Excel ≤ 120秒
- **AI图片识别时间**: 单张图片 ≤ 5秒
- **报价计算响应时间**: ≤ 100ms（实时计算）
- **表格刷新时间**: ≤ 1秒（1000条客户数据以内）
- **邮件发送速度**: ≥ 10封/秒（单个SMTP连接）
- **数据导出时间**: ≤ 5秒（10,000条记录以内）

---

#### 5.1.2 并发性能

- **支持并发用户数**: ≥ 100（同时在线用户）
- **邮件发送并发**: 支持10个用户同时发送邮件
- **批量上传并发**: 单用户可同时上传最多50张名片

---

#### 5.1.3 数据容量

- **单用户客户数据上限**: ≥ 50,000条（可扩展）
- **单用户产品数据上限**: ≥ 100,000条（可扩展）
- **单次批量操作上限**: 最多选择1,000个客户执行批量邮件发送
- **附件大小限制**: 单封邮件附件 ≤ 10MB
- **名片图片大小限制**: 单张 ≤ 10MB
- **产品Excel文件大小限制**: 单个 ≤ 50MB
- **AI识图上传图片限制**: 单张 ≤ 5MB
- **单次报价单产品数量**: ≤ 500个

---

### 5.2 可用性需求

#### 5.2.1 系统可用性

- **系统可用率**: ≥ 99.5%（每月停机时间 ≤ 3.6小时）
- **计划内维护**: 提前48小时通知用户
- **故障恢复时间** (MTTR): ≤ 4小时

---

#### 5.2.2 用户体验

- **界面语言**: 简体中文（本期）
- **浏览器兼容性**: 
  - 支持Chrome 90+, Edge 90+, Firefox 88+, Safari 14+
  - 不支持IE浏览器
- **屏幕分辨率**: 最低支持1366x768
- **响应式设计**: 支持桌面端和平板端（≥ 768px），不支持手机端
- **无障碍访问**: 支持键盘导航，满足WCAG 2.0 AA级标准

---

#### 5.2.3 易用性

- **新用户引导**: 首次登录提供产品功能导览（可跳过）
- **操作提示**: 关键操作（如批量删除、邮件发送）提供二次确认
- **错误提示**: 清晰的错误提示信息，提供解决方案（如"邮箱格式错误，请检查"）
- **帮助文档**: 提供在线帮助文档和视频教程

---

### 5.3 安全需求

#### 5.3.1 身份认证与授权

- **用户注册**: 支持邮箱注册 + 邮箱验证
- **登录方式**: 用户名/邮箱 + 密码登录
- **密码强度**: 要求至少8位，包含大小写字母、数字
- **会话管理**: 7天免登录（可配置），30分钟无操作自动退出
- **密码找回**: 通过邮箱验证码重置密码

---

#### 5.3.2 数据安全

- **传输加密**: 全站HTTPS，TLS 1.2+
- **存储加密**: 敏感字段（密码、邮箱、电话）加密存储
- **SQL注入防护**: 使用参数化查询，防止SQL注入
- **XSS防护**: 对用户输入进行转义，防止跨站脚本攻击
- **CSRF防护**: 使用CSRF Token验证表单提交

---

#### 5.3.3 邮件安全

- **SMTP认证**: 使用用户自己的SMTP服务器（需配置账号密码）
- **发送频率限制**: 单用户每小时最多发送500封邮件（防止被标记为垃圾邮件）
- **退信处理**: 自动记录退信邮箱，避免重复发送
- **黑名单管理**: 支持用户维护邮箱黑名单

---

### 5.4 兼容性需求

- **操作系统**: Windows 10+, macOS 10.14+, Linux (Ubuntu 18.04+)
- **邮件服务兼容性**: 支持标准SMTP协议（如Gmail、Outlook、QQ邮箱、163邮箱等）
- **Excel格式**: 导入导出支持.xlsx格式（Excel 2007+）
- **图片格式**: 支持JPG、PNG、HEIC格式的名片图片

---

### 5.5 可维护性需求

- **日志记录**: 记录所有关键操作（登录、上传、邮件发送、错误等）
- **监控告警**: 监控系统性能、错误率，异常时自动告警
- **版本管理**: 代码使用Git版本控制，遵循语义化版本规范
- **文档完善**: 提供开发文档、API文档、部署文档

---

### 5.6 可扩展性需求

- **模块化设计**: 各功能模块独立，便于后续扩展新模块（如CRM、订单管理等）
- **API设计**: 提供RESTful API，便于第三方集成
- **数据库设计**: 预留扩展字段，支持未来功能迭代
- **微服务架构**: 考虑采用微服务架构，便于横向扩展

---

## 6. 发布标准与衡量指标

### 6.1 发布标准 (Release Criteria)

#### 6.1.1 功能完整性

- ✅ 完成3.1节中列出的所有核心功能
- ✅ 通过所有用户故事的验收标准
- ✅ 前端侧边栏预留所有规划模块入口（含"即将推出"标识）
- ✅ 平台基础框架搭建完成（用户系统、导航、权限基础）
- ✅ 无P0/P1级bug（阻塞性、严重bug）
- ✅ P2级bug（一般bug）≤ 5个

---

#### 6.1.2 性能达标

- ✅ OCR识别准确率 ≥ 90%（关键字段）
- ✅ 邮件发送成功率 ≥ 95%（有效邮箱）
- ✅ AI图片OE编号识别准确率 ≥ 90%
- ✅ Excel产品图片提取成功率 ≥ 99%
- ✅ 页面加载时间 ≤ 2秒
- ✅ 报价计算响应时间 ≤ 100ms
- ✅ 系统稳定性测试通过（无内存泄漏、无崩溃）

---

#### 6.1.3 安全测试

- ✅ 通过安全漏洞扫描（SQL注入、XSS、CSRF等）
- ✅ 通过渗透测试（模拟攻击测试）
- ✅ 数据加密正确实施
- ✅ 隐私政策和用户协议已上线

---

#### 6.1.4 用户测试

- ✅ 完成内部测试（团队成员使用真实场景测试）
- ✅ 完成Beta测试（邀请5-10个目标用户测试）
- ✅ 用户满意度 ≥ 80%
- ✅ 用户任务完成率 ≥ 95%

---

### 6.2 衡量指标 (Success Metrics)

#### 6.2.1 核心业务指标

**名片识别相关**:
- **日均上传名片数**: 目标 ≥ 1,000张/天（3个月后）
- **识别准确率**: ≥ 90%（用户不修改识别结果的比例）
- **人工修改率**: ≤ 30%（用户需手动修改识别结果的比例）

**邮件营销相关**:
- **日均邮件发送量**: 目标 ≥ 10,000封/天（3个月后）
- **邮件发送成功率**: ≥ 95%
- **邮件模板复用率**: ≥ 60%（使用历史模板的比例）
- **发送日志导出率**: ≥ 40%（用户导出日志的比例）

**产品管理相关**:
- **产品数据量**: 目标 ≥ 50,000条（3个月后）
- **日均报价单生成量**: 目标 ≥ 500份/天（3个月后）
- **OE编号搜索匹配率**: ≥ 85%（搜索到的产品/搜索的编号）
- **AI识图使用率**: ≥ 30%（使用AI识图的报价/总报价）
- **报价单导出率**: ≥ 70%（导出的报价单/生成的报价单）

**用户活跃度**:
- **DAU (日活跃用户)**: 目标 ≥ 500人（6个月后）
- **MAU (月活跃用户)**: 目标 ≥ 2,000人（6个月后）
- **用户留存率**: 
  - 次日留存 ≥ 60%
  - 7日留存 ≥ 40%
  - 30日留存 ≥ 30%

---

#### 6.2.2 产品体验指标

- **新用户上手时间**: ≤ 10分钟（从注册到完成第一次邮件发送）
- **功能使用率**: 
  - 名片上传功能使用率 ≥ 90%
  - 邮件发送功能使用率 ≥ 80%
  - 模板保存功能使用率 ≥ 60%
  - 产品搜索报价功能使用率 ≥ 70%
  - AI识图报价功能使用率 ≥ 30%
- **用户满意度** (NPS): ≥ 50分
- **客户支持工单量**: ≤ 5个/周（初期）

---

#### 6.2.3 技术性能指标

- **系统可用率**: ≥ 99.5%
- **平均响应时间**: ≤ 2秒
- **错误率**: ≤ 0.1%（API请求错误率）
- **OCR识别延迟**: ≤ 3秒/张

---

### 6.3 关键成功因素 (Critical Success Factors)

1. **OCR识别准确率**: 直接影响用户体验和工作效率，是核心竞争力
2. **邮件送达率**: 影响营销效果，需持续优化SMTP配置和反垃圾邮件策略
3. **易用性**: 目标用户可能不熟悉技术，需降低学习成本
4. **数据安全**: 涉及客户信息，必须确保数据安全和隐私保护

---

## 7. 待定项与未来规划

### 7.1 本期待定项 (Open Questions)

以下问题需在开发前明确：

#### 7.1.1 技术选型相关

1. **前端框架选择**: 
   - 方案A：Vue 3 + TypeScript + Ant Design Vue
   - 方案B：React 18 + TypeScript + Ant Design
   - 方案C：Next.js (React) + Tailwind CSS
   - **建议**: 根据团队技术栈选择，优先考虑方案A或B（成熟稳定）

2. **后端技术选择**: 
   - 方案A：Python + Django + Django REST Framework（适合快速开发）
   - 方案B：Python + FastAPI（高性能API）
   - 方案C：Node.js + NestJS（前后端统一语言）
   - **建议**: 方案A或B，Python生态适合AI集成

3. **OCR服务商选择**: 
   - 待评估：百度OCR vs 腾讯OCR vs 阿里云OCR vs 自研模型
   - 决策依据：准确率、成本、API稳定性、海外服务支持
   - 预估成本：0.01-0.05元/张

4. **邮件发送方式**: 
   - 方案A：用户使用自己的SMTP服务器（需配置账号密码）✅ 推荐
   - 方案B：平台提供统一SMTP服务（可能被标记为垃圾邮件）
   - 方案C：集成第三方邮件营销服务（如SendGrid、Mailgun）
   - **推荐**: 方案A（本期）+ 方案C（后续可选）

#### 7.1.2 平台架构相关

5. **前端路由配置方式**: 
   - 方案A：静态路由配置（所有模块路由写死在代码中，未开发的模块导向占位页）
   - 方案B：动态路由配置（从后端获取用户可访问的模块列表，动态生成路由）
   - **建议**: 方案A（本期简单），方案B（后续支持权限控制时切换）

6. **模块间数据共享方式**: 
   - 方案A：共享数据库表（客户表被多个模块直接访问）
   - 方案B：通过统一的客户服务API访问（推荐，模块解耦）
   - **建议**: 方案B，便于后续微服务拆分

7. **侧边栏菜单配置**: 
   - 方案A：前端硬编码所有模块菜单
   - 方案B：后端配置菜单数据（包括模块状态：已上线/开发中/规划中）
   - **建议**: 方案B，便于灵活调整模块显示和状态

#### 7.1.3 商业模式相关

8. **定价策略**: 
   - 免费版：每月500张名片识别 + 2,000封邮件发送
   - 基础版：¥299/月，5,000张名片 + 10,000封邮件
   - 专业版：¥999/月，无限名片 + 50,000封邮件
   - 企业版：定制化服务 + 私有化部署
   - **待决策**: 是否提供永久免费版，还是限时免费试用？

9. **部署方式**: 
   - SaaS模式（云端部署，用户在线使用）✅ 优先
   - 私有化部署（企业内部部署，后续提供）
   - **推荐**: 优先SaaS模式，快速验证市场

10. **数据存储位置**: 
    - 国内客户：阿里云/腾讯云（国内服务器）
    - 国际客户：AWS/Azure（海外服务器）
    - 需符合数据本地化要求

#### 7.1.4 产品体验相关

11. **首次使用引导**: 
    - 方案A：弹窗式新手引导（Intro.js）
    - 方案B：视频教程 + 示例数据
    - 方案C：交互式任务引导（完成第一个名片识别、发送第一封邮件）
    - **建议**: 方案C，用户参与感强

12. **未开发模块的处理**: 
    - 方案A：点击后弹出"即将推出"提示框
    - 方案B：导向专门的占位页（含功能介绍、预计上线时间、订阅通知）
    - **建议**: 方案B，顺便收集用户需求

---

### 7.2 未来功能规划 (Future Roadmap)

#### Phase 1 (3个月内) - 客户管理模块深化
**目标**: 完善客户管理功能，提升用户粘性

- ✨ 邮件打开率和点击率追踪
- ✨ 邮件退订管理
- ✨ 客户标签系统（自定义标签、智能标签）
- ✨ 高级筛选功能（组合条件、保存筛选器）
- ✨ 批量导入Excel客户信息（智能字段映射）
- ✨ 客户详情页（完整客户画像、跟进记录）
- ✨ 移动端H5适配（查看客户、发送邮件）

---

#### Phase 2 (6个月内) - 销售管理模块上线
**目标**: 打通客户到订单的完整业务链路

**新增模块: 销售管理**
- 📝 报价单管理
  - 在线生成报价单（支持多种货币）
  - 报价单模板管理
  - 报价单发送与追踪
  - 报价单版本对比
- 📄 合同管理
  - 合同在线签署（集成电子签名）
  - 合同模板库
  - 合同到期提醒
- 📦 订单管理
  - 订单创建与跟踪
  - 订单状态流转
  - 订单与物流关联
- 📊 销售漏斗可视化
  - 商机阶段管理
  - 转化率分析
  - 预测销售额

**客户管理模块增强**
- 客户跟进记录（时间线展示）
- 团队协作功能（客户分配、权限管理）
- 数据统计与分析（客户来源、转化漏斗）
- 微信集成（扫码添加客户微信）

---

#### Phase 3 (12个月内) - 物流与供应链模块
**目标**: 覆盖外贸业务后端流程，实现全流程数字化

**新增模块: 物流跟踪**
- 🚚 订单物流管理
  - 物流信息录入（船期、柜号、提单号）
  - 物流状态实时追踪（对接物流API）
  - 到货提醒
- 🌍 国际货运管理
  - 海运/空运/陆运路线管理
  - 运费计算器
  - 货运代理联系人管理
- 🛃 清关进度跟踪
  - 清关文档管理
  - 清关状态追踪
  - 关税计算

**新增模块: 供应链管理**
- 🏭 供应商管理
  - 供应商信息库
  - 供应商评级
  - 采购记录
- 📋 采购管理
  - 采购订单管理
  - 采购成本分析
- 📦 库存管理
  - 库存实时查询
  - 库存预警
  - 出入库记录

**新增模块: 文档中心**
- 📄 智能文档管理
  - 合同/发票/证书自动归档
  - OCR识别文档内容
  - 文档搜索与预览
- 📁 文档模板库
  - 常用文档模板（合同、发票、装箱单等）
  - 一键生成文档

**平台能力增强**
- 🤖 AI客户推荐和商机预测
- 💬 智能邮件内容生成（基于GPT）
- 🔗 第三方系统集成（ERP、财务系统、报关系统）
- 📱 移动端APP（iOS + Android）

---

#### Phase 4 (18个月内) - 数据智能与行业深化
**目标**: 通过AI赋能，提供行业洞察和智能决策支持

**新增模块: 数据分析与BI**
- 📊 可视化数据大屏
  - 销售数据实时监控
  - 客户分析看板
  - 业务健康度指标
- 🔮 智能预测
  - 销售额预测
  - 客户流失预警
  - 库存需求预测
- 📈 自定义报表
  - 拖拽式报表设计器
  - 定时报表自动生成

**新增模块: 团队协作**
- 👥 团队管理
  - 多角色权限体系
  - 部门/小组管理
- 📋 工作流引擎
  - 审批流程配置（报价审批、合同审批）
  - 待办任务提醒
- 💬 内部沟通
  - 即时消息（类似企业微信）
  - 客户/订单评论讨论

**行业深化**
- 🎯 垂直行业解决方案
  - 卡车及重型机械行业版
  - 汽车配件行业版
  - 工程机械行业版
- 🌐 全球化
  - 多语言支持（英语、西班牙语、俄语、阿拉伯语等）
  - 全球化部署（多区域服务器）
  - 多币种支持
- 🎙️ AI能力升级
  - AI语音助手（语音录入客户信息）
  - AR名片扫描（通过手机摄像头实时识别）
  - 智能客服机器人

---

#### Phase 5 (24个月+) - 生态与开放平台
**目标**: 构建开放生态，成为行业标准工具

- 🔌 开放API平台
  - RESTful API开放
  - Webhook事件通知
  - API市场
- 🧩 插件市场
  - 第三方插件接入
  - 自定义功能扩展
- 🤝 行业生态合作
  - 对接货代平台
  - 对接报关系统
  - 对接金融服务（信用保险、贸易融资）

---

### 7.3 技术债务与优化计划

- **性能优化**: 引入Redis缓存，优化数据库查询
- **代码重构**: 统一代码规范，提升代码质量
- **测试覆盖**: 单元测试覆盖率 ≥ 80%
- **监控完善**: 引入APM工具（如New Relic、DataDog）
- **文档完善**: 补充API文档、开发者文档

---

## 附录

### A. 术语表 (Glossary)

- **OCR**: Optical Character Recognition，光学字符识别
- **SMTP**: Simple Mail Transfer Protocol，简单邮件传输协议
- **NER**: Named Entity Recognition，命名实体识别
- **GDPR**: General Data Protection Regulation，通用数据保护条例
- **NPS**: Net Promoter Score，净推荐值
- **DAU/MAU**: Daily/Monthly Active Users，日活/月活用户
- **P0/P1/P2**: Bug优先级（P0=阻塞级，P1=严重，P2=一般）

---

### B. 参考资料 (References)

- 《产品需求文档(PRD)编写指南》
- 《GDPR合规实践指南》
- 《反垃圾邮件最佳实践》(CAN-SPAM Act, GDPR Email Marketing)
- 《OCR技术在名片识别中的应用》

---

### C. 变更记录 (Change Log)

| 版本 | 日期 | 修改人 | 修改内容 |
|------|------|--------|----------|
| v1.0 | 2025-12-02 | [产品经理] | 初始版本创建 |
| v1.1 | 2025-12-03 | [产品经理] | 新增产品管理模块（产品导入、产品目录、智能报价、OE搜索、AI识图报价） |

---

**文档结束**

